# Бэкенд онлайн-магазина

Этот репозиторий содержит приложения бэкенда и фронтенда для проекта образовательного онлайн-магазина. Он предоставляет функциональность для управления продуктами, пользователями, корзиной, заказами, аутентификацией и связанными операциями.

## Технологии и инструменты

Проект использует следующие технологии и инструменты:

- **Язык программирования**: Python
- **Backend фреймворки/библиотеки**: Ariadne, Flask, SQLAlchemy, MinIO
- **База данных**: PostgreSQL
- **Хранилище файлов**: MinIO
- **API тип**: GraphQL API
- **Контейнизация**: Docker

## Требования

Для запуска этого приложения необходимо выполнить следующие требования:

- Python 3.10 или выше
- Docker и Docker Compose (если запуск приложения с использованием Docker)

## Установка и использование

Чтобы установить и запустить приложение в режиме разработки, выполните следующие шаги:

### Клонирование репозитория и настройка переменных окружения

1. Клонируйте репозиторий: `git clone https://github.com/Desunovu/graphql-store-backend.git`.
2. Переименуйте `./backend/.env.example` в `./backend/.env`

Теперь запустите приложение, используя один из следующих методов:

#### Запуск с использованием Docker

1. Отредактируйте файл `./backend/.env`, указав адреса подключения в `MINIO_ENDPOINT` (адрес должен быть доступен для frontend пользователя).
2. Выполните команду `docker-compose --profile full up --build`, чтобы развернуть всё приложение, включая необходимые службы.

#### Запуск Back-end приложения в ручном режиме

1. - Вариант 1: Разверните службы `postgres` и `minio` с помощью `docker-compose --profile dev up --build`. 
   - Вариант 2: Разверните и настройте службы `postgres` и `minio` независимо.
2. Отредактируйте файл `./backend/.env`, указав адреса подключения в `MINIO_ENDPOINT` и `POSTGRES_HOST`.
3. Установите зависимости: `pip install -r requirements.txt`.
4. Установите переменную окружения `FLASK_APP` в имя главного пакета `core`.
5. Запустите приложение: `flask run`.

## GraphQL API

API предоставляет следующие мутации:

- `createUser`: Регистрация нового пользователя.
- `updateUser`: Обновление информации о пользователе.
- `uploadAvatar`: Загрузка аватара пользователя.
- `deleteUser`: Удаление пользователя.
- `assignAdmin`: Назначение пользователю роли администратора.
- `addProduct`: Добавление нового продукта.
- `updateProduct`: Обновление информации о продукте.
- `deleteProduct`: Удаление продукта.
- `addCategory`: Создание новой категории.
- `removeCategory`: Удаление категории.
- `addReview`: Оставление или обновление отзыва.
- `removeReview`: Удаление отзыва.
- `createOrder`: Создание нового заказа.
- `updateOrderStatus`: Обновление статуса заказа.
- `addProductToFavorites`: Добавление продукта в избранное.
- `removeProductFromFavorites`: Удаление продукта из избранного.
- `createCharacteristic`: Создание новой характеристики.
- `deleteCharacteristic`: Удаление характеристики.
- `addProductToCart`: Добавление продукта в корзину.
- `removeProductFromCart`: Удаление продукта из корзины.
- `setProductCharacteristicValue`: Установка значения для характеристики продукта.

А также следующие запросы:

- `loginUser`: Получение токена авторизации.
- `getUser`: Получение информации о пользователе.
- `getUsers`: Получение списка пользователей.
- `getProduct`: Получение информации о продукте.
- `getProducts`: Получение списка продуктов.
- `getCart`: Получение информации о корзине.
- `getCategories`: Получение списка категорий.
- `getOrders`: Получение списка заказов.
- `getFavoriteProducts`: Получение списка избранных продуктов.
- `getCharacteristics`: Получение списка доступных характеристик.