# Бэкенд онлайн-магазина

Этот репозиторий содержит приложение бэкенда для проекта образовательного онлайн-магазина. Он предоставляет функциональность для управления продуктами, пользователями, корзиной, заказами, аутентификацией и связанными операциями.

Веб-клиент фронтенда доступен по следующей ссылке: [react-store-frontend](https://github.com/Desunovu/react-store-frontend)

## Технологии и инструменты

Проект использует следующие технологии и инструменты:

- **Язык программирования**: Python
- **Фреймворк**: Flask
- **Объектно-реляционное отображение (ORM)**: SQLAlchemy
- **База данных**: PostgreSQL
- **Хранилище файлов**: MinIO
- **API**: GraphQL API
- **Библиотека GraphQL**: Ariadne
- **Контейнизация**: Docker

## Требования

Для запуска этого приложения необходимо выполнить следующие требования:

- Python 3.10 или выше
- Docker и Docker Compose (если запуск приложения с использованием Docker)

## Установка и использование

Чтобы установить и запустить приложение в режиме разработки, выполните следующие шаги:

### Клонирование репозитория и настройка переменных окружения

1. Клонируйте репозиторий: `git clone https://github.com/Desunovu/graphql-store-backend.git`.
2. Перейдите в каталог проекта.
3. Отредактируйте файл `.env`, указав адрес устройства в локальной сети для переменных `MINIO_ENDPOINT` и `POSTGRES_HOST`.

Теперь запустите приложение, используя один из следующих методов:

### Запуск с использованием Docker

1. Выполните команду `docker-compose --profile full up -d`, чтобы развернуть всё приложение, включая необходимые службы.

### Запуск приложения в ручном режиме

1. Вариант 1: Разверните службы `postgres` и `minio` с помощью `docker-compose up -d`.

   **Примечание:** Если вы выберете этот вариант, перейдите к шагу 3.

2. Вариант 2: Разверните и настройте службы `postgres` и `minio` независимо. Обновите файл `.env` необходимыми подключениями.

3. Установите зависимости: `pip install -r requirements.txt`.
4. Установите переменную окружения `FLASK_APP` в имя главного пакета `core`.
5. Запустите приложение: `flask run`.

## GraphQL API

API предоставляет следующие мутации:

- `createUser`: Регистрация нового пользователя.
- `updateUser`: Обновление информации о пользователе.
- `uploadAvatar`: Загрузка аватара пользователя.
- `deleteUser`: Удаление пользователя.
- `assignAdmin`: Назначение пользователю роли администратора.
- `addProduct`: Добавление нового продукта.
- `updateProduct`: Обновление информации о продукте.
- `deleteProduct`: Удаление продукта.
- `addCategory`: Создание новой категории.
- `removeCategory`: Удаление категории.
- `addReview`: Оставление или обновление отзыва.
- `removeReview`: Удаление отзыва.
- `createOrder`: Создание нового заказа.
- `updateOrderStatus`: Обновление статуса заказа.
- `addProductToFavorites`: Добавление продукта в избранное.
- `removeProductFromFavorites`: Удаление продукта из избранного.
- `createCharacteristic`: Создание новой характеристики.
- `deleteCharacteristic`: Удаление характеристики.
- `addProductToCart`: Добавление продукта в корзину.
- `removeProductFromCart`: Удаление продукта из корзины.
- `setProductCharacteristicValue`: Установка значения для характеристики продукта.

А также следующие запросы:

- `loginUser`: Получение токена авторизации.
- `getUser`: Получение информации о пользователе.
- `getUsers`: Получение списка пользователей.
- `getProduct`: Получение информации о продукте.
- `getProducts`: Получение списка продуктов.
- `getCart`: Получение информации о корзине.
- `getCategories`: Получение списка категорий.
- `getOrders`: Получение списка заказов.
- `getFavoriteProducts`: Получение списка избранных продуктов.
- `getCharacteristics`: Получение списка доступных характеристик.